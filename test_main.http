###
# üß© TEST MAIN ‚Äî API Tienda Online
# Autor: Pablo ‚Äî Proyecto Parcial FastAPI
# Objetivo: Validar endpoints CRUD, l√≥gica de negocio, relaciones y reglas
###

@baseUrl = http://127.0.0.1:8000

##############################################################
# 1Ô∏è‚É£ CREAR CATEGOR√çAS
##############################################################

POST {{baseUrl}}/categorias/
Content-Type: application/json

{
  "nombre": "Electr√≥nica",
  "descripcion": "Productos tecnol√≥gicos como celulares y laptops"
}

###

POST {{baseUrl}}/categorias/
Content-Type: application/json

{
  "nombre": "Ropa",
  "descripcion": "Moda y prendas para hombres y mujeres"
}

###

POST {{baseUrl}}/categorias/
Content-Type: application/json

{
  "nombre": "Hogar",
  "descripcion": "Art√≠culos para el hogar y cocina"
}

##############################################################
# 2Ô∏è‚É£ LISTAR CATEGOR√çAS ACTIVAS
##############################################################

GET {{baseUrl}}/categorias/

# üí¨ Esperado: Lista con las categor√≠as creadas (3 activas)

##############################################################
# 3Ô∏è‚É£ ACTUALIZAR CATEGOR√çA
##############################################################

PUT {{baseUrl}}/categorias/1
Content-Type: application/json

{
  "descripcion": "Dispositivos electr√≥nicos y tecnol√≥gicos modernos"
}

# üí¨ Esperado: categor√≠a actualizada correctamente

##############################################################
# 4Ô∏è‚É£ DESACTIVAR UNA CATEGOR√çA
##############################################################

PATCH {{baseUrl}}/categorias/3/desactivar

# üí¨ Esperado: categor√≠a "Hogar" inactiva

##############################################################
# 5Ô∏è‚É£ REACTIVAR CATEGOR√çA (Nueva funcionalidad)
##############################################################

PATCH {{baseUrl}}/categorias/3/reactivar

# üí¨ Esperado: categor√≠a "Hogar" reactivada (activa = true)

##############################################################
# 6Ô∏è‚É£ CREAR PRODUCTOS
##############################################################

POST {{baseUrl}}/productos/
Content-Type: application/json

{
  "nombre": "Laptop Lenovo",
  "descripcion": "Laptop potente para trabajo y estudio",
  "precio": 3200.50,
  "stock": 10,
  "categoria_id": 1
}

###

POST {{baseUrl}}/productos/
Content-Type: application/json

{
  "nombre": "Camiseta Oversize",
  "descripcion": "Camiseta 100% algod√≥n",
  "precio": 35.99,
  "stock": 25,
  "categoria_id": 2
}

###

POST {{baseUrl}}/productos/
Content-Type: application/json

{
  "nombre": "Plancha Oster",
  "descripcion": "Plancha de vapor moderna",
  "precio": 150.00,
  "stock": 5,
  "categoria_id": 3
}

###

POST {{baseUrl}}/productos/
Content-Type: application/json

{
  "nombre": "Mouse Gamer",
  "descripcion": "Mouse RGB con 6 botones programables",
  "precio": 120.75,
  "stock": 0,
  "categoria_id": 1
}

# üí¨ Esperado: todos los productos creados correctamente (stock no negativo)

##############################################################
# 7Ô∏è‚É£ LISTAR PRODUCTOS (todos)
##############################################################

GET {{baseUrl}}/productos/

# üí¨ Esperado: todos los productos creados (4 registros)

##############################################################
# 8Ô∏è‚É£ LISTAR PRODUCTOS POR FILTRO (por categor√≠a)
##############################################################

GET {{baseUrl}}/productos/?categoria_id=1

# üí¨ Esperado: productos de Electr√≥nica

##############################################################
# 9Ô∏è‚É£ FILTRAR PRODUCTOS POR PRECIO
##############################################################

GET {{baseUrl}}/productos/?precio_min=100&precio_max=200

# üí¨ Esperado: productos con precio entre 100 y 200 (ej. Mouse y Plancha)

##############################################################
# üîü FILTRAR PRODUCTOS POR STOCK (rango)
##############################################################

GET {{baseUrl}}/productos/?stock_min=20&stock_max=30

# üí¨ Esperado: productos dentro del rango, o mensaje "No hay productos disponibles"

##############################################################
# 11Ô∏è‚É£ OBTENER PRODUCTO CON SU CATEGOR√çA
##############################################################

GET {{baseUrl}}/productos/1

# üí¨ Esperado: producto "Laptop Lenovo" con su categor√≠a "Electr√≥nica"

##############################################################
# 12Ô∏è‚É£ OBTENER CATEGOR√çA CON SUS PRODUCTOS
##############################################################

GET {{baseUrl}}/categorias/1

# üí¨ Esperado: categor√≠a "Electr√≥nica" con lista de productos (Laptop, Mouse)

##############################################################
# 13Ô∏è‚É£ ACTUALIZAR PRODUCTO
##############################################################

PUT {{baseUrl}}/productos/1
Content-Type: application/json

{
  "precio": 2999.99,
  "descripcion": "Laptop actualizada - versi√≥n 2025"
}

# Esperado: Laptop actualizada correctamente

##############################################################
# 14Ô∏è‚É£ DESACTIVAR PRODUCTO
##############################################################

PATCH {{baseUrl}}/productos/4/desactivar

# üí¨ Esperado: producto "Mouse Gamer" ahora inactivo

##############################################################
# 15Ô∏è‚É£ REACTIVAR PRODUCTO (nueva funcionalidad)
##############################################################

PATCH {{baseUrl}}/productos/4/reactivar

# üí¨ Esperado: producto "Mouse Gamer" reactivado

##############################################################
# 16Ô∏è‚É£ RESTAR STOCK (simula una compra)
##############################################################

PATCH {{baseUrl}}/productos/1/restar_stock?cantidad=3

# üí¨ Esperado: stock de Laptop Lenovo reducido de 10 ‚Üí 7

##############################################################
# 17Ô∏è‚É£ ERROR DE L√ìGICA - STOCK NEGATIVO
##############################################################

PATCH {{baseUrl}}/productos/3/restar_stock?cantidad=99

# üí¨ Esperado: error 400 con mensaje ‚ÄúNo se puede dejar stock negativo‚Äù

##############################################################
# 18Ô∏è‚É£ ERROR DE L√ìGICA - NOMBRE DE CATEGOR√çA DUPLICADO
##############################################################

POST {{baseUrl}}/categorias/
Content-Type: application/json

{
  "nombre": "Electr√≥nica",
  "descripcion": "Intento duplicado"
}

# üí¨ Esperado: error 409 ‚ÄúEl nombre de la categor√≠a ya existe‚Äù
